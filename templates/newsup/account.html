<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>个人中心</title>
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<link type="text/css" rel="stylesheet" src="{{ static_url('weui/css/weui.min.css') }}">
	<link type="text/css" rel="stylesheet" src="{{ static_url('weui/css/jquery-weui.min.css') }}">
	<link href="{{ static_url('leshui/css/order.css') }}" type="text/css" rel="stylesheet">
	<script type="text/javascript" src="{{ static_url('leshui/js/jquery-1.12.1.min.js') }}"></script>
</head>
<html>
<body>
	<!-- socialbar -->
	{% module Template("newsup/block-socialbar.html", is_login=is_login, is_ops=is_ops) %}
	<!-- /socialbar -->
	<!-- 导航 -->
	<div class="nav_all">
		<div class="nav">
			<a href="/">首页</a>
			<a class="menu_scenery" href="javascript:;">景区导览</a>
			<a class="menu_activity" href="javascript:;">近期活动</a>
			<a class="menu_product" href="javascript:;">旅游产品</a>
			<a class="menu_news" href="javascript:;">旅游资讯</a>
			<a class="menu_media" href="javascript:;">精彩瞬间</a>
			{% if is_login  and is_ops %}
			<a class="menu_supplier" href="javascript:;">供应商</a>
			<a class="menu_require" href="javascript:;">景区需求</a>
			<a class="menu_community" href="javascript:;">经验交流</a>
			<a class="menu_supplier_product" href="javascript:;">供应商产品</a>
			<a class="menu_supplier_require" href="javascript:;">供应商需求</a>
			{% end %}
		</div>
	</div>
	<!-- 手机版头部 -->
		<div class="ph_nav">
			<h1><img src="{{ static_url('leshui/images/nav.png') }}"></h1>
			<h2><img src="{{ static_url('leshui/images/cha.png') }}"></h2>
			<ul>
				<li><a href="/">首页</a></li>
				<li class="menu_scenery"><a href="javascript:;">景区导览</a></li>
				<li class="menu_activity"><a href="javascript:;">近期活动</a></li>
				<li class="menu_product"><a href="javascript:;">旅游产品</a></li>
				<li class="menu_news"><a href="javascript:;">旅游资讯</a></li>
				<li class="menu_media"><a href="javascript:;">精彩瞬间</a></li>
				{% if is_login  and is_ops %}
				<li class="menu_supplier"><a href="javascript:;">供应商</a></li>
				<li class="menu_require"><a href="javascript:;">景区需求</a></li>
				<li class="menu_community"><a href="javascript:;">经验交流</a></li>
				<li class="menu_supplier_product"><a href="javascript:;">供应商产品</a></li>
				<li class="menu_supplier_require"><a href="javascript:;">供应商需求</a></li>
				{% end %}
			</ul>
		</div>
	<!-- 导航 -->

<!-- 主题内容 -->
<div class="order">
	<h1>会员中心</h1>
	<div class="order_left">
		<b>我的订单</b>
		<ul id="cent_dd">
			<li><span>全部订单</span><i>></i></li>
			<li><span>已付款订单</span><i>></i></li>
			<li><span>待付款订单</span><i>></i></li>
		</ul>
		<b>个人信息</b>
		<ul id="cent_pep">
			<li><span>修改密码</span><i>></i></li>
			<li><span>修改信息</span><i>></i></li>
			<li><span>实名认证</span><i>></i></li>
			<li><span>快递地址</span><i>></i></li>
		</ul>
	</div>
	<div class="order_right">
		<!-- 我的订单内容 -->
		<div class="center_dd">
			<div class="order_bot_title">
				<ul>
					<li class="order_hao">订单号</li>
					<li class="order_maney">金额(元)</li>
					<li class="order_zt">订单状态</li>
					<li class="order_xq">订单详情</li>
				</ul>
			</div>
			<div id="order_right">
				<div class="order_main">
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">待付款</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">已付款</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">已完成</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">已取消</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
				</div>
				<div class="order_main">
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">已付款</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">已完成</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
				</div>
				<div class="order_main">
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">待付款</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
					<ul>
						<li class="order_hao">100245201</li>
						<li class="order_maney">￥5450</li>
						<li class="order_zt">已取消</li>
						<li class="order_xq">
							<dl>
								<dt>
									<a href="#"><img src="images/sm_img.png"></a>
								</dt>
								<dd>
									<p><a href="#">9月2日 徒步宜兴竹海，登苏南第一峰</a></p>
									<em><img src="images/time2.png" alt="">8月31日<span>星期四</span></em>
								</dd>
							</dl>
						</li>
					</ul>
					<input type="submit" value="立即支付" class="pay">
				</div>
			</div>
		</div>

		<!-- 个人信息内容 -->
		<div class="center_peple">
			<!-- 修改密码 -->
			<div class="zc_main">
				<h2>修改密码</h2>
				<ul>
					<li>
						<i>旧密码：</i>
						<input type="text" placeholder="请输入旧密码" />
					</li>
					<li>
						<i>新密码：</i>
						<input type="text" placeholder="请输入新密码" />
					</li>
					<li>
						<i>确认新密码：</i>
						<input type="text" placeholder="请再次输入新密码" />
					</li>

					<li class="zc_email">
						<i class="zc_greed">&nbsp;</i>
						<input name="" type="submit" class="lo_login" value="确定" />
					</li>
				</ul>

			</div>
			<!-- 修改信息 -->
			<div class="zc_main">
				<h2>修改信息</h2>
				<form>
				<ul>
					<li>
						<i>昵称：</i>
						<input type="text" id="nickName" placeholder="昵称" value="{{ user['nickname'] }}" />
					</li>
					<li>
						<i class="yk_xb">性别：</i>
						  <p class="yk_pepl">
						    <label>
						      <input type="radio" name="RadioGroup1" value="男" id="RadioGroup1_0" checked="checked" class="yk_label" />
						      男</label>
						    <label>
						      <input type="radio" name="RadioGroup1" value="女" id="RadioGroup1_1" class="yk_label" />
						      女</label>
						  </p>
					</li>
					<li>
						<i>手机号码：</i>
						<input type="text" placeholder="手机号码" value="{{ user['login'] }}" readOnly="true"/>
					</li>
					<li class="xx_tx">
						<i class="xx_tx">头像：</i>
						<img id="user_img" src="{{ user['avatar'] }}" alt="touxiang" style="width:180px;" />
						<input type="file" id="file" name="file" style="display:none;">
						<em class="xx_gg" onclick="openBrowse()">更改</em>
					</li>
					<li>
						<i>生日：</i>
						<select name="" class="yk_happy1">
						    <option>1977</option>
						    <option>1978</option>
						    <option>1979</option>
						    <option>1980</option>
						</select>
						<strong>年</strong>
						<select name="" class="yk_happy">
						    <option>1</option>
						    <option>2</option>
						    <option>3</option>
						    <option>4</option>
						</select>
						<strong>月</strong>
						<select name="" class="yk_happy">
						    <option>1</option>
						    <option>2</option>
						    <option>3</option>
						    <option>4</option>
						</select>
						<strong>日</strong>
					</li>
					<li>
						<i>群体：</i>
						<select name="">
						    <option>学生</option>
						    <option>上班族</option>
						    <option>中年</option>
						    <option>老年</option>
						    <option>其他</option>
						</select>
					</li>
					<li>
						<i>爱好：</i>
						<select name="">
						    <option>徒步</option>
						    <option>骑行</option>
						    <option>露营</option>
						    <option>自驾</option>
						    <option>其他</option>
						</select>
					</li>
					<li>
						<i>婚姻状况：</i>
						<select name="">
						    <option>单身</option>
						    <option>已婚</option>
						    <option>保密</option>
						</select>
					</li>
					<li>
						<i>月收入：</i>
						<select name="">
						    <option>2000元以下</option>
						    <option>2000-3999</option>
						    <option>4000-5999</option>
						    <option>6000-7999</option>
						    <option>8000元以上</option>
						</select>
					</li>
					<li>
						<i>教育程度：</i>
						<select name="">
						    <option>初中</option>
						    <option>高中</option>
						    <option>中专</option>
						    <option>大专</option>
						    <option>本科</option>
						    <option>硕士</option>
						    <option>博士</option>
						    <option>其他</option>
						</select>
					</li>
					<li>
						<i>所在行业：</i>
						<select name="">
						    <option>IT、互联网</option>
						    <option>教育行业</option>
						    <option>医院</option>
						    <option>电子行业</option>
						    <option>其他</option>
						</select>
					</li>

					<li class="zc_email">
						<i class="zc_greed">&nbsp;</i>
						<input name="" type="button" class="xx_login" value="确定" id="account-btn" />
						<input name="" type="button" class="xx_false" value="取消" onclick="reset();" />
					</li>
				</ul>
				</form>
			</div>
			<!-- 实名认证 -->
			<div class="zc_main">
				<h2>实名认证</h2>
				<ul>
					<li>
						<i>姓名：</i>
						<input type="text" placeholder="请您的真实姓名" />
					</li>
					<li>
						<i>身份证号：</i>
						<input type="text" placeholder="请输入您的身份证号" />
					</li>
					<li class="zc_email">
						<i class="zc_greed">&nbsp;</i>
						<input name="" type="submit" class="lo_login" value="确定" />
					</li>
				</ul>

			</div>
			<!-- 快递地址 -->
			<div class="adrees_main">
				<h2>快递地址</h2>
				<ul>
					<li>
						<i>所在地区：</i>
						<input type="text" placeholder="请填写所在地区" />
					</li>
					<li>
						<i>详细地址：</i>
						<textarea name="" cols="10" rows="20" style="resize:none;"></textarea>
					</li>
					<li>
						<i>邮政编码：</i>
						<input type="text" placeholder="请输入邮政编码" />
					</li>
					<li>
						<i>收货人姓名：</i>
						<input type="text" placeholder="请输入收货人姓名" />
					</li>
					<li>
						<i>联系电话：</i>
						<input type="text" placeholder="请输入联系电话" />
					</li>
					<li class="zc_email">
						<i class="zc_greed">&nbsp;</i>
						<input name="" type="submit" class="lo_login" value="确定" />
					</li>
				</ul>

			</div>

		</div>
	</div>

</div>
<!-- 主题内容 -->

<!-- Footer -->
{% module Template("newsup/block-footer.html", is_login=is_login, is_ops=is_ops) %}
<!-- End Footer -->
<script src="{{ static_url('leshui/js/index.js') }}" type="text/javascript"></script>
<script src="{{ static_url('leshui/js/order.js') }}" type="text/javascript"></script>
<script type="text/javascript" src="{{ static_url('weui/js/jquery-weui.min.js') }}"></script>
<!-- fileinput -->
<script src="{{ static_url('upyun/js/fileinput.min.js') }}"></script>
<script src="{{ static_url('upyun/js/spark-md5.min.js') }}"></script>
<script src="{{ static_url('upyun/js/async.js') }}"></script>
<script src="{{ static_url('upyun/js/upyun-mu.js') }}"></script>
<script>

  function uuid() {
    var s = [];
    var hexDigits = "0123456789abcdef";
    for (var i = 0; i < 36; i++) {
      s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
    }
    s[14] = "4"; // bits 12-15 of the time_hi_and_version field to 0010
    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01
    s[8] = s[13] = s[18] = s[23] = "-";

    var uuid = s.join("");
    return uuid;
  }

  function uploadUpyun(file, elementId) {
    var ext = '.' + file.name.split('.').pop();

    var config = {
      // 空间名称
      bucket: '{{upyun_bucket}}',
      // 上传请求过期时间
      expiration: parseInt((new Date().getTime() + 3600000) / 1000),
      // 尽量不要使用直接传表单 API 的方式，以防泄露造成安全隐患
      form_api_secret: '{{upyun_form_api_secret}}'
    };

    var instance = new Sand(config);
    var options = {
      'notify_url': '{{upyun_notify_url}}'
    };
    instance.setOptions(options);
    instance.setElementId(elementId);

    var d = new Date();
    var month = d.getMonth() + 1;
    var filename = '/avatar/' + d.getFullYear() + '/' + month + '/' + d.getDate() + '/' + uuid() + ext;
    console.log(filename);
    instance.upload(filename);

    return '{{upyun_domain}}' + filename;
  };

  $("#file").on("change",function(){
      var times = 0;
      var imgUrl = uploadUpyun(this.files[0],"file");
      $('#loadingToast').show();
      document.addEventListener('uploaded',function(e){
        if(times == 0){
          $("#user_img").attr('src',imgUrl);
          $('#loadingToast').hide();
        }
        times ++;
      });
  });

	$(function(){
			$('#account-btn').on('click',function(){
				saveInfo();
			});
	    function saveInfo(){
	      var data = { nickname:$("#nickName").val(),
	                   avatar:$("#user_img").attr('src'),
	                 };
	      var json = JSON.stringify(data);

	      $.ajax({
	        url:'{{api_domain}}/api/myinfo',
	        type:'PUT',
	        data:json,
	        dataType: "json",
	        headers: {"Authorization":"Bearer {{access_token}}"},
	        contentType: 'application/json',
	        success: function(data, status, xhr) {
	          $.toast("操作成功");
	        },
	        error:function(){
	        }

	      });

	    };
		});

    //file 打开文件
    function openBrowse(){
        var ie=navigator.appName=="Microsoft Internet Explorer" ? true : false;
        if(ie){
            document.getElementById("file").click();
            document.getElementById("filename").value=document.getElementById("file").value;
        }else{
            var a=document.createEvent("MouseEvents");//FF的处理
            a.initEvent("click", true, true);
            document.getElementById("file").dispatchEvent(a);
        }
    };

</script>
</body>
</html>
